Previous Stats
==========================

Flow Status	Successful - Fri Jan 27 19:48:34 2023
Quartus Prime Version	21.1.1 Build 850 06/23/2022 SJ Lite Edition
Revision Name	pipeline
Top-level Entity Name	Pipeline
Family	MAX 10
Device	10M04SAE144A7G
Timing Models	Final
Total logic elements	2,943 / 4,032 ( 73 % )
Total registers	759
Total pins	53 / 101 ( 52 % )
Total virtual pins	0
Total memory bits	1,024 / 193,536 ( < 1 % )
Embedded Multiplier 9-bit elements	6 / 40 ( 15 % )
Total PLLs	0 / 1 ( 0 % )
UFM blocks	0 / 1 ( 0 % )
ADC blocks	0 / 1 ( 0 % )

60.36MHz

Current Stats
===============================

Flow Status	Successful - Sat Feb  4 21:04:08 2023
Quartus Prime Version	21.1.1 Build 850 06/23/2022 SJ Lite Edition
Revision Name	pipeline
Top-level Entity Name	Pipeline
Family	MAX 10
Device	10M04SAE144A7G
Timing Models	Final
Total logic elements	2,846 / 4,032 ( 71 % )
Total registers	736
Total pins	39 / 101 ( 39 % )
Total virtual pins	0
Total memory bits	1,296 / 193,536 ( < 1 % )
Embedded Multiplier 9-bit elements	6 / 40 ( 15 % )
Total PLLs	0 / 1 ( 0 % )
UFM blocks	0 / 1 ( 0 % )
ADC blocks	0 / 1 ( 0 % )

58.48MHz

Speed-up tests:
=================

1. Remove mem_av: this seems to be the most critical path. At least I think that's what it is.
2. Removed multiplier, which - even with DSP blocks seems to be rather slow
3. After these, it seems that most violations are around the DDR nature of the memory controller.
   Of course, I'm trying to close timing on that for 5ns (200MHz), which is quite tight on a MAX10.
4. I think one of the problems is the bypass path auto-generated by Quartus. This is an extra 2.4ns.
5. Now the double-add in execute (to compute physical memory addresses) seems to be the problem.
   not to mention that that was incorrect there: we would only need to add the offset in TASK mode!
6. I managed to get the CAS generation down to a single LUT. Still timing doesn't close as just the I/O
   buffer alone adds about 5ns of latency. In reality though, there is no need for these signals to
   have any timing relationship with the clock, certainly not for these experiments. Yes, the capturing
   of data happens on the clock-edge, and in that sense it's needed to be in sync, but that only applies
   to the actual clock rate of ~10MHz. For that, we're clearly good.
7. Now that I've removed I/O timing constraints, the timing closure got lifted to 76MHz.
   The critical path is still in 'execute', this time it's the shift register. However, a bunch of other
   paths are soon after it, so really, I think the problem is the large selection mux at the end of execute.
   I think there's an interesting idea here: in reality we have an extra cycle for execute, if we wanted to:
   right now we're wasting it in memory. Really, the moral of the story is that we should have execute and
   memory in parallel instead of serial. Just for kicks, what if I insert a reg in exec?
8. We're at the same spot, in fact a little lower: 74MHz. Similar problems, except now on some other output
   to memory.

Comparison
==========

According  to http://downloads.aries-embedded.de/products/Spiderboard/riscv-on-max10-userguide.pdf, most RiscV implementations are around the same size, though quite a bit faster.

RAM behavior
============

Quartus complains that RAMs implement read-new-data behavior (which they do, now that I look at the RTL) and that it needs to insert a bypass pass.
This is sometihng that I should either turn off or make controllable in Silicon.

Report before RAM change

Flow Status	Successful - Sun Feb  5 11:18:46 2023
Quartus Prime Version	21.1.1 Build 850 06/23/2022 SJ Lite Edition
Revision Name	pipeline
Top-level Entity Name	Pipeline
Family	MAX 10
Device	10M04SAE144A7G
Timing Models	Final
Total logic elements	2,869 / 4,032 ( 71 % )
Total registers	805
Total pins	39 / 101 ( 39 % )
Total virtual pins	0
Total memory bits	1,296 / 193,536 ( < 1 % )
Embedded Multiplier 9-bit elements	0 / 40 ( 0 % )
Total PLLs	0 / 1 ( 0 % )
UFM blocks	0 / 1 ( 0 % )
ADC blocks	0 / 1 ( 0 % )

53.8MHz

After: 55.93MHz. Not a ton of change. Of course, this is limited by the DRAM interface at this point
